{% extends 'base.html' %}
{% load static %}

{% block title %}Dashboard | AlifPro{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto py-6 space-y-6">

    <!-- Welcome Header -->
    <div class="flex items-center justify-between">
        <div>
            {% if user.username %}
            <h1 class="text-2xl font-bold text-white">Salom, {{ user.username }}!</h1>
            {% else %}
            <h1 class="text-2xl font-bold text-white">Salom, O'quvchi!</h1>
            {% endif %}
            <p class="text-slate-400 text-sm">Bugun nimani o'rganamiz?</p>
        </div>

        {% if game %}
        <div class="flex items-center gap-4">
            <!-- Streak -->
            <div class="flex items-center gap-2 px-3 py-2 bg-orange-500/10 rounded-lg border border-orange-500/20">
                <span class="text-xl">ğŸ”¥</span>
                {% if game.current_streak %}
                <span class="font-bold text-orange-400">{{ game.current_streak }} kun</span>
                {% else %}
                <span class="font-bold text-orange-400">0 kun</span>
                {% endif %}
            </div>
            <!-- XP -->
            <div class="flex items-center gap-2 px-3 py-2 bg-emerald-500/10 rounded-lg border border-emerald-500/20">
                <span class="text-xl">â­</span>
                {% if game.xp_total %}
                <span class="font-bold text-emerald-400">{{ game.xp_total }} XP</span>
                {% else %}
                <span class="font-bold text-emerald-400">0 XP</span>
                {% endif %}
            </div>
        </div>
        {% endif %}
    </div>

    <!-- Main Grid -->
    <div class="grid lg:grid-cols-3 gap-6">

        <!-- Left Column (2/3) -->
        <div class="lg:col-span-2 space-y-6">

            <!-- Continue Learning -->
            {% if user.profile.current_course %}
            <div class="bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl p-6">
                <h2 class="text-xl font-bold text-white mb-2">Davom eting</h2>
                <p class="text-indigo-200 mb-4">{{ user.profile.current_course.title }}</p>
                <a href="{% url 'arab:course_detail' pk=user.profile.current_course.id %}"
                    class="inline-block px-5 py-2 bg-white text-indigo-600 font-bold rounded-lg hover:bg-indigo-100 transition">
                    O'qishni boshlash â†’
                </a>
            </div>
            {% endif %}

            <!-- Quick Actions -->
            <div class="grid grid-cols-4 gap-3">
                <a href="/alphabet/"
                    class="p-4 rounded-xl bg-slate-800/50 border border-white/5 hover:bg-slate-800 transition text-center">
                    <div class="text-2xl mb-1">ğŸ”¤</div>
                    <div class="text-sm font-medium text-white">Alifbo</div>
                </a>
                <a href="/dictionary/"
                    class="p-4 rounded-xl bg-slate-800/50 border border-white/5 hover:bg-slate-800 transition text-center">
                    <div class="text-2xl mb-1">ğŸ“š</div>
                    <div class="text-sm font-medium text-white">Lug'at</div>
                </a>
                <a href="/practice/"
                    class="p-4 rounded-xl bg-slate-800/50 border border-white/5 hover:bg-slate-800 transition text-center">
                    <div class="text-2xl mb-1">ğŸ¯</div>
                    <div class="text-sm font-medium text-white">Mashq</div>
                </a>
                <a href="/leagues/"
                    class="p-4 rounded-xl bg-slate-800/50 border border-white/5 hover:bg-slate-800 transition text-center">
                    <div class="text-2xl mb-1">ğŸ†</div>
                    <div class="text-sm font-medium text-white">Liga</div>
                </a>
            </div>

            <!-- Available Courses -->
            <div class="bg-slate-900/50 rounded-2xl border border-white/5 p-5">
                <h3 class="text-lg font-bold text-white mb-4">Mavjud Kurslar</h3>
                <div class="space-y-3">
                    {% for course in courses %}
                    <a href="{% url 'arab:course_detail' pk=course.id %}"
                        class="flex items-center gap-4 p-3 rounded-xl bg-slate-800/50 hover:bg-slate-800 transition">
                        <div class="w-10 h-10 rounded-lg bg-slate-700 flex items-center justify-center text-xl">
                            {% if course.level == 'A0' %}ğŸŒ±{% elif course.level == 'A1' %}ğŸŒ¿{% else %}ğŸŒ³{% endif %}
                        </div>
                        <div class="flex-1">
                            <div class="font-medium text-white">{{ course.title }}</div>
                            <div class="text-xs text-slate-500">{{ course.level }} daraja</div>
                        </div>
                        <i class="fas fa-chevron-right text-slate-500"></i>
                    </a>
                    {% empty %}
                    <p class="text-slate-500 text-sm">Kurslar topilmadi</p>
                    {% endfor %}
                </div>
            </div>

        </div>

        <!-- Right Sidebar (1/3) -->
        <div class="space-y-6">

            <!-- User Stats Card -->
            <div class="bg-slate-900/50 rounded-2xl border border-white/5 p-5">
                <h3 class="font-bold text-white mb-4">Sizning statistikangiz</h3>
                <div class="space-y-3">
                    <div class="flex justify-between items-center">
                        <span class="text-slate-400">Level</span>
                        {% if game.level %}
                        <span class="font-bold text-white">{{ game.level }}</span>
                        {% else %}
                        <span class="font-bold text-white">1</span>
                        {% endif %}
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-slate-400">Liga</span>
                        <span class="font-bold text-yellow-400">{{ game.get_current_league_display }}</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-slate-400">Yuraklar</span>
                        {% if game.hearts %}
                        <span class="font-bold text-red-400">â¤ï¸ {{ game.hearts }}</span>
                        {% else %}
                        <span class="font-bold text-red-400">â¤ï¸ 5</span>
                        {% endif %}
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-slate-400">Liga XP</span>
                        {% if game.league_xp %}
                        <span class="font-bold text-emerald-400">{{ game.league_xp }}</span>
                        {% else %}
                        <span class="font-bold text-emerald-400">0</span>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Daily Quests -->
            {% if daily_quests %}
            <div class="bg-slate-900/50 rounded-2xl border border-white/5 p-5">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="font-bold text-white flex items-center gap-2">
                        <span class="text-yellow-500">ğŸ“œ</span> Kunlik missiyalar
                    </h3>
                </div>
                <div class="space-y-3">
                    {% for uq in daily_quests %}
                    <div class="p-3 rounded-xl bg-slate-800/50 border border-white/5">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm text-white">{{ uq.mission.title }}</span>
                            <span class="text-xs text-emerald-400">+{{ uq.mission.xp_reward }} XP</span>
                        </div>
                        <div class="h-1.5 bg-slate-900 rounded-full">
                            {% if uq.progress_percent %}
                            <div class="h-full bg-emerald-500 rounded-full" style="width: {{ uq.progress_percent }}%">
                            </div>
                            {% else %}
                            <div class="h-full bg-emerald-500 rounded-full" style="width: 0%">
                            </div>
                            {% endif %}
                        </div>
                        <div class="text-xs text-slate-500 mt-1">{{ uq.current_progress }}/{{ uq.mission.required_count }}</div>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <!-- Shop Link -->
            <a href="/shop/"
                class="block bg-gradient-to-r from-sky-600 to-cyan-600 rounded-2xl p-5 hover:scale-[1.02] transition">
                <h3 class="font-bold text-white mb-1">ğŸ›’ Do'kon</h3>
                <p class="text-sky-200 text-sm">Streak Freeze va boshqa itemlar</p>
            </a>

        </div>

    </div>

</div>
{% endblock %}