{% extends "base.html" %}
{% block title %}Fe'l Mashqi | AlifPro{% endblock %}
{% block content %}

<div class="max-w-3xl mx-auto py-12 px-4">
    <!-- Header -->
    <div class="text-center mb-10">
        <div
            class="inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-cyan-500/10 border border-cyan-500/20 text-[10px] font-black uppercase tracking-widest text-cyan-400 mb-4">
            FE'L MASHQI
        </div>
        <h1 class="text-3xl font-black text-white">Tuslanish Testi</h1>
    </div>

    <!-- Quiz Card -->
    <div class="p-8 rounded-[3rem] bg-slate-900/60 border border-white/10" id="quizCard">
        <!-- Verb Info -->
        <div class="text-center mb-8">
            <div class="text-sm text-slate-400 mb-2">Fe'l:</div>
            <div class="text-4xl font-arabic text-white mb-2">{{ verb.past_base|default:"ŸÉŸéÿ™Ÿéÿ®Ÿé" }}</div>
            <div class="text-slate-400">{{ verb.translation_uz|default:"Yozdi" }}</div>
        </div>

        <!-- Task -->
        <div class="p-6 rounded-2xl bg-cyan-500/10 border border-cyan-500/30 mb-6 text-center">
            <div class="text-sm text-slate-400 mb-2">Quyidagi shaklni toping:</div>
            <div class="text-xl text-white">
                <span class="text-cyan-400">{{ target_tense|default:"Moziy" }}</span> -
                <span class="text-amber-400">{{ target_person|default:"Huwa" }}</span>
            </div>
        </div>

        <!-- Options -->
        <div class="grid grid-cols-2 gap-4" id="optionsGrid">
            {% for option in options %}
            <button type="button" onclick="checkAnswer('{{ option }}', '{{ correct_answer|default:"" }}')"
                class="option-btn p-6 rounded-2xl bg-slate-800 border border-white/10 text-2xl font-arabic text-white hover:border-cyan-500/50 hover:bg-slate-700 transition-all">
                {{ option }}
            </button>
            {% empty %}
            <div class="col-span-2 text-center py-8 text-slate-500">
                Ma'lumot yuklanmoqda...
            </div>
            {% endfor %}
        </div>

        <!-- Result -->
        <div id="resultArea" class="hidden mt-8 p-6 rounded-2xl text-center">
            <div id="resultIcon" class="text-6xl mb-4"></div>
            <div id="resultText" class="text-2xl font-bold mb-4"></div>
            <a href="{% url 'arab:verb_practice_session' %}"
                class="inline-block px-6 py-3 rounded-xl bg-cyan-500 text-slate-900 font-bold hover:bg-cyan-400 transition-all">
                Keyingi savol <i class="fas fa-arrow-right ml-2"></i>
            </a>
        </div>
    </div>

    <!-- Back Link -->
    <div class="mt-8 text-center">
        <a href="{% url 'arab:verb_practice_index' %}" class="text-slate-400 hover:text-cyan-400 transition-colors">
            <i class="fas fa-arrow-left mr-2"></i>Fe'llarga qaytish
        </a>
    </div>
</div>

<script>
    function checkAnswer(selected, correct) {
        if (!selected || !correct) return;

        const buttons = document.querySelectorAll('.option-btn');
        const resultArea = document.getElementById('resultArea');
        const resultIcon = document.getElementById('resultIcon');
        const resultText = document.getElementById('resultText');

        buttons.forEach(btn => {
            btn.disabled = true;
            if (btn.textContent.trim() === correct) {
                btn.classList.add('border-emerald-500', 'bg-emerald-500/20');
            } else if (btn.textContent.trim() === selected && selected !== correct) {
                btn.classList.add('border-rose-500', 'bg-rose-500/20');
            }
        });

        resultArea.classList.remove('hidden');

        if (selected === correct) {
            resultArea.classList.add('bg-emerald-500/20');
            resultIcon.textContent = 'üéâ';
            resultText.textContent = "To'g'ri!";
            resultText.classList.add('text-emerald-400');
        } else {
            resultArea.classList.add('bg-rose-500/20');
            resultIcon.textContent = '‚ùå';
            resultText.textContent = "Noto'g'ri";
            resultText.classList.add('text-rose-400');
        }
    }
</script>

{% endblock %}