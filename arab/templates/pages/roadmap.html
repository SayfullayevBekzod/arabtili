{% extends "base.html" %}
{% block title %}Roadmap - AlifPro Academy{% endblock %}
{% block content %}

<div class="max-w-6xl mx-auto px-4 py-8 relative overflow-hidden">
  <!-- Immersive Page Background -->
  <div class="fixed inset-0 pointer-events-none -z-10">
    <div class="absolute top-0 -left-64 h-[600px] w-[600px] rounded-full bg-emerald-500/10 blur-[150px] animate-pulse">
    </div>
    <div class="absolute bottom-0 -right-64 h-[600px] w-[600px] rounded-full bg-sky-500/10 blur-[150px] animate-pulse"
      style="animation-delay: 2s"></div>
  </div>

  <!-- Top Header Section -->
  <header
    class="relative z-10 flex flex-col md:flex-row md:items-end justify-between gap-8 mb-20 animate-in fade-in slide-in-from-bottom-5 duration-700">
    <div class="space-y-4">
      <div
        class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-white/5 border border-white/10 text-[10px] font-black tracking-[0.2em] text-emerald-400 uppercase">
        <i class="fas fa-map"></i> Sarguzasht yo'li
      </div>
      <h1 class="text-5xl md:text-7xl font-black text-white leading-none tracking-tighter">
        O'sish <span class="text-transparent bg-clip-text bg-gradient-to-r from-emerald-400 to-sky-400">Xaritasi</span>
      </h1>
      <p class="text-slate-400 text-lg max-w-2xl leading-relaxed font-medium">
        Arab tilini noldan mukammallikka qadar bo'lgan masofani biz bilan bosing. Har bir qadamda yangi bilim va tajriba
        kutmoqda.
      </p>
    </div>

    <div class="flex gap-4">
      <a href="/alphabet/"
        class="group relative px-8 py-4 rounded-2xl bg-emerald-500 text-slate-950 font-black text-sm tracking-widest overflow-hidden hover:scale-105 transition-all shadow-[0_20px_50px_rgba(16,185,129,0.3)]">
        <span class="relative z-10">üöÄ START A0</span>
        <div class="absolute inset-0 bg-white opacity-0 group-hover:opacity-20 transition-opacity"></div>
      </a>
    </div>
  </header>

  <!-- THE INTERACTIVE PATH CONTAINER -->
  <div class="relative min-h-[1000px] py-20">

    <!-- Animated Wavy Path (SVG) -->
    <svg class="absolute left-1/2 -translate-x-1/2 top-0 w-full max-w-[800px] h-full pointer-events-none opacity-20"
      viewBox="0 0 100 1000" preserveAspectRatio="none">
      <path id="roadmapPath" d="M 50 0 Q 80 150 50 300 Q 20 450 50 600 Q 80 750 50 900 Q 20 1050 50 1200"
        stroke="url(#pathGradient)" stroke-width="0.5" fill="none" class="animate-draw" />
      <defs>
        <linearGradient id="pathGradient" x1="0%" y1="0%" x2="0%" y2="100%">
          <stop offset="0%" style="stop-color:#10b981; stop-opacity:1" />
          <stop offset="50%" style="stop-color:#3b82f6; stop-opacity:1" />
          <stop offset="100%" style="stop-color:#8b5cf6; stop-opacity:1" />
        </linearGradient>
      </defs>
    </svg>

    <!-- Roadmap Content -->
    <div class="relative z-10 space-y-32">
      {% for lvl, courses in roadmap_rows %}
      <div class="roadmap-item relative flex flex-col md:flex-row items-center gap-12 group"
        style="{% if forloop.counter0|divisibleby:2 %}flex-direction: row;{% else %}flex-direction: row-reverse;{% endif %}">

        <!-- Node (The Circle) -->
        <div class="relative shrink-0">
          <div
            class="node-glow absolute inset-0 rounded-full blur-xl opacity-0 group-hover:opacity-60 transition-opacity duration-500
                      {% if lvl == 'A0' %} bg-emerald-400 {% elif lvl == 'Quran' %} bg-violet-400 {% elif lvl == 'B1' %} bg-sky-400 {% else %} bg-slate-500 {% endif %}">
          </div>

          <div
            class="relative h-24 w-24 rounded-full p-1 bg-gradient-to-br 
                      {% if lvl == 'A0' %} from-emerald-400 to-teal-600 {% elif lvl == 'Quran' %} from-violet-400 to-purple-600 {% elif lvl == 'B1' %} from-sky-400 to-blue-600 {% else %} from-slate-700 to-slate-900 {% endif %}
                      shadow-2xl transform transition-transform duration-500 group-hover:scale-125 group-hover:rotate-12">
            <div
              class="h-full w-full rounded-full bg-slate-950 flex flex-col items-center justify-center border-4 border-slate-900 shadow-inner">
              <span class="text-3xl">
                {% if lvl == "A0" %}‚≠ê{% elif lvl == "Quran" %}üïå{% elif lvl == "B1" %}üèÅ{% else %}üîí{% endif %}
              </span>
              <span class="text-[10px] font-black uppercase tracking-widest mt-1 text-white/60">{{ lvl }}</span>
            </div>
          </div>
          <div
            class="absolute left-1/2 top-full h-32 w-0.5 bg-gradient-to-b from-white/10 to-transparent -translate-x-1/2 block md:hidden">
          </div>
        </div>

        <!-- Card content -->
        <div class="w-full max-w-xl roadmap-card-container">
          <div
            class="roadmap-card relative p-8 md:p-10 rounded-[3rem] border border-white/10 bg-slate-900 shadow-2xl transition-all duration-500 
                      hover:bg-slate-900/80 hover:border-white/20 hover:shadow-emerald-500/5 group-hover:-translate-y-2">
            <div class="absolute top-6 right-8 text-[10px] font-black tracking-[0.2em] text-slate-500 uppercase">
              {% if lvl == "A0" %}
              Joriy bosqich
              {% elif lvl == "Quran" %}
              Maxsus darslar
              {% else %}
              Yaqinda
              {% endif %}
            </div>
            <div class="space-y-6">
              <div class="space-y-2">
                <h3 class="text-3xl md:text-4xl font-black text-white">
                  {% if lvl == "A0" %}
                  Boshlang'ich Bosqich
                  {% elif lvl == "A1" %}
                  Elementar Daraja
                  {% elif lvl == "A2" %}
                  Muloqot Asoslari
                  {% elif lvl == "B1" %}
                  Mustaqil O'rganuvchi
                  {% elif lvl == "Quran" %}
                  Tajvid & Tilovat
                  {% endif %}
                </h3>
                <div class="flex flex-wrap gap-2">
                  {% if lvl == "A0" %}
                  <span
                    class="px-3 py-1 rounded-full bg-emerald-500/10 text-emerald-400 text-[10px] font-black uppercase">Start</span>
                  {% elif lvl == "Quran" %}
                  <span
                    class="px-3 py-1 rounded-full bg-violet-500/10 text-violet-400 text-[10px] font-black uppercase">Extra</span>
                  {% endif %}
                  <span class="px-3 py-1 rounded-full bg-white/5 text-slate-500 text-[10px] font-black uppercase">{{ lvl }} daraja</span>
                </div>
              </div>
              <p class="text-slate-400 leading-relaxed font-medium">
                {% if lvl == "A0" %}
                Arab alifbosini mukammal o'rganing. 28 ta harfning yozilishi va talaffuzi. Ilk 100 ta eng kerakli
                so'zlar lug'ati.
                {% elif lvl == "A1" %}
                Soddalashtirilgan grammatika va so'z boyligini oshirish. "Match Game" va "Kuchsiz So'zlar" mashqlari
                orqali xotirani mustahkamlash.
                {% elif lvl == "A2" %}
                Kundalik muloqot uchun zarur iboralar. Tinglab tushunish va qisqa matnlar bilan ishlash.
                {% elif lvl == "B1" %}
                "Smart Takrorlash" tizimi orqali bilimlarni chuqurlashtirish. Xattotlik va murakkab matnlar tahlili.
                {% elif lvl == "Quran" %}
                Qur'on o'qish qoidalari (Tajvid). Maxsus harakatlar va talaffuz sirlari. Suralarni to'g'ri o'qishni
                mashq qilish.
                {% endif %}
              </p>

              {% if courses %}
              <div class="rounded-[2rem] border border-white/10 bg-white/5 p-5">
                <div class="text-[10px] font-black tracking-[0.2em] text-slate-500 uppercase mb-3">
                  Kurslar
                </div>
                <div class="space-y-2">
                  {% for c in courses %}
                  <a href="{% url 'arab:course_detail' c.id %}"
                    class="block rounded-2xl border border-white/10 bg-slate-950/40 px-4 py-3 hover:bg-white/10 transition">
                    <div class="flex items-center justify-between gap-3">
                      <div class="text-sm font-black text-white">{{ c.title }}</div>
                      <div class="text-xs text-slate-400">‚Üí</div>
                    </div>
                    {% if c.description %}
                    <div class="mt-1 text-xs text-slate-400 line-clamp-2">{{ c.description }}</div>
                    {% endif %}
                  </a>
                  {% endfor %}
                </div>
              </div>
              {% endif %}

              <div class="flex items-center justify-between pt-6 border-t border-white/5">
                <div class="flex -space-x-3">
                  <div
                    class="h-8 w-8 rounded-full bg-emerald-500/20 border-2 border-slate-900 grid place-items-center text-[10px]">
                    ‚ú®</div>
                  <div
                    class="h-8 w-8 rounded-full bg-sky-500/20 border-2 border-slate-900 grid place-items-center text-[10px]">
                    üß†</div>
                  <div
                    class="h-8 w-8 rounded-full bg-amber-500/20 border-2 border-slate-900 grid place-items-center text-[10px]">
                    üìö</div>
                </div>
                {% if lvl == "A0" %}
                <a href="/alphabet/"
                  class="px-6 py-3 rounded-2xl bg-white text-slate-950 font-black text-xs tracking-widest hover:bg-emerald-400 transition-colors">KIRISH
                  ‚Üí</a>
                {% elif lvl == "Quran" %}
                <a href="/quran/"
                  class="px-6 py-3 rounded-2xl bg-white/5 border border-white/10 text-white font-black text-xs tracking-widest hover:bg-white/10 transition-colors">O'RISH
                  ‚Üí</a>
                {% else %}
                <button disabled
                  class="px-6 py-3 rounded-2xl bg-white/5 border border-white/5 text-slate-600 font-black text-xs tracking-widest cursor-not-allowed flex items-center gap-2">
                  <i class="fas fa-lock"></i> Yopiq
                </button>
                {% endif %}
              </div>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>

  <!-- Final Footer Card -->
  <section
    class="relative z-10 mt-32 p-1 rounded-[3.5rem] bg-gradient-to-r from-emerald-500 via-sky-500 to-violet-500 shadow-3xl">
    <div class="bg-slate-950 rounded-[3.4rem] p-10 md:p-16 text-center space-y-8">
      <h2 class="text-4xl md:text-6xl font-black text-white leading-tight">Muvaffaqiyatga bir qadam qoldi!</h2>
      <p class="text-slate-400 max-w-2xl mx-auto text-lg">
        Sizning ta'lim yo'lingiz allaqachon belgilangan. Hoziroq start tugmasini bosing va o'zingiz uchun yangi
        eshiklarni oching.
      </p>
      <div class="flex flex-wrap justify-center gap-4">
        <a href="/alphabet/"
          class="px-12 py-5 rounded-[2rem] bg-emerald-500 text-slate-950 font-black text-sm tracking-widest hover:scale-105 transition-all">DA'VOT
          QILAMIZ</a>
        <a href="/courses/"
          class="px-12 py-5 rounded-[2rem] bg-white/5 border border-white/10 text-white font-black text-sm tracking-widest hover:bg-white/10 transition-all">KURSLAR</a>
      </div>
    </div>
  </section>
</div>

<style>
  @keyframes draw {
    from {
      stroke-dashoffset: 2000;
    }

    to {
      stroke-dashoffset: 0;
    }
  }

  #roadmapPath {
    stroke-dasharray: 2000;
    animation: draw 10s linear infinite forwards;
  }

  .roadmap-item {
    transition: all 0.8s cubic-bezier(0.16, 1, 0.3, 1);
  }

  .roadmap-card {
    perspective: 1000px;
    transform-style: preserve-3d;
  }

  .roadmap-card::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: 3rem;
    padding: 2px;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), transparent, rgba(16, 185, 129, 0.1));
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    pointer-events: none;
  }

  .reveal-active {
    opacity: 1 !important;
    transform: translateY(0) !important;
  }

  .reveal-hidden {
    opacity: 0;
    transform: translateY(50px);
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const items = document.querySelectorAll('.roadmap-item');
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('reveal-active');
        }
      });
    }, { threshold: 0.2 });
    items.forEach(item => {
      item.classList.add('reveal-hidden');
      observer.observe(item);
    });
  });
</script>

{% endblock %}