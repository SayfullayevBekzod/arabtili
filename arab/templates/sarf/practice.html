{% extends "base.html" %}
{% block title %}Sarf Mashqi | AlifPro{% endblock %}
{% block content %}

<div class="max-w-3xl mx-auto py-12 px-4">
    <!-- Header -->
    <div class="text-center mb-10">
        <div
            class="inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-violet-500/10 border border-violet-500/20 text-[10px] font-black uppercase tracking-widest text-violet-400 mb-4">
            SARF MASHQI
        </div>
        <h1 class="text-3xl font-black text-white">Hosila Yasash</h1>
    </div>

    <!-- Quiz Card -->
    <div class="p-8 rounded-[3rem] bg-slate-900/60 border border-white/10" id="quizCard">
        <!-- Root Display -->
        <div class="text-center mb-8">
            <div class="text-sm text-slate-400 mb-2">Ildiz:</div>
            <div class="text-5xl font-arabic text-white mb-2">{{ root.letters }}</div>
            <div class="text-slate-400">{{ root.translation_uz }}</div>
        </div>

        <!-- Source Form -->
        <div class="p-4 rounded-2xl bg-slate-800/50 border border-white/5 mb-6">
            <div class="text-xs text-slate-500 mb-1">{{ source.get_form_type_display }}:</div>
            <div class="text-3xl font-arabic text-violet-400 text-center">{{ source.arabic }}</div>
        </div>

        <!-- Question -->
        <div class="text-center mb-6">
            <i class="fas fa-arrow-down text-2xl text-violet-400 mb-4"></i>
            <div class="text-white text-lg">
                <span class="text-amber-400">{{ target_type_display }}</span> shaklini toping:
            </div>
        </div>

        <!-- Options -->
        <div class="grid grid-cols-2 gap-4" id="optionsGrid">
            {% for option in options %}
            <button type="button" onclick="checkAnswer('{{ option }}', '{{ correct_answer }}')"
                class="option-btn p-6 rounded-2xl bg-slate-800 border border-white/10 text-2xl font-arabic text-white hover:border-violet-500/50 hover:bg-slate-700 transition-all">
                {{ option }}
            </button>
            {% endfor %}
        </div>

        <!-- Result (hidden initially) -->
        <div id="resultArea" class="hidden mt-8 p-6 rounded-2xl text-center">
            <div id="resultIcon" class="text-6xl mb-4"></div>
            <div id="resultText" class="text-2xl font-bold mb-4"></div>
            <a href="{% url 'arab:sarf_practice' %}"
                class="inline-block px-6 py-3 rounded-xl bg-violet-500 text-white font-bold hover:bg-violet-400 transition-all">
                Keyingi savol <i class="fas fa-arrow-right ml-2"></i>
            </a>
        </div>
    </div>

    <!-- Back Link -->
    <div class="mt-8 text-center">
        <a href="{% url 'arab:sarf_index' %}" class="text-slate-400 hover:text-violet-400 transition-colors">
            <i class="fas fa-arrow-left mr-2"></i>Ildizlarga qaytish
        </a>
    </div>
</div>

<script>
    function checkAnswer(selected, correct) {
        const buttons = document.querySelectorAll('.option-btn');
        const resultArea = document.getElementById('resultArea');
        const resultIcon = document.getElementById('resultIcon');
        const resultText = document.getElementById('resultText');

        buttons.forEach(btn => {
            btn.disabled = true;
            if (btn.textContent.trim() === correct) {
                btn.classList.add('border-emerald-500', 'bg-emerald-500/20');
            } else if (btn.textContent.trim() === selected && selected !== correct) {
                btn.classList.add('border-rose-500', 'bg-rose-500/20');
            }
        });

        resultArea.classList.remove('hidden');

        if (selected === correct) {
            resultArea.classList.add('bg-emerald-500/20');
            resultIcon.textContent = 'üéâ';
            resultText.textContent = "To'g'ri!";
            resultText.classList.add('text-emerald-400');
        } else {
            resultArea.classList.add('bg-rose-500/20');
            resultIcon.textContent = '‚ùå';
            resultText.textContent = "Noto'g'ri";
            resultText.classList.add('text-rose-400');
        }
    }
</script>

{% endblock %}